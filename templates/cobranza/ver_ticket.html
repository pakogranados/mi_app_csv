{% extends "sidebar.html" %}
{% block content %}

<div class="container mt-4" style="max-width: 800px;">
  <div class="card">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0">üßæ Ticket #{{ venta.id }}</h4>
    </div>
    <div class="card-body">
      
      <!-- Info del ticket -->
      <div class="row mb-4">
        <div class="col-6">
          <strong>Fecha:</strong> {{ venta.fecha.strftime('%d/%m/%Y') }}<br>
          <strong>Hora:</strong> {{ venta.fecha.strftime('%H:%M:%S') }}
        </div>
        <div class="col-6 text-end">
          <strong>Cajero:</strong> {{ venta.cajero or 'N/A' }}<br>
          <strong>Usuario ID:</strong> {{ venta.usuario_id }}
        </div>
      </div>

      <!-- Detalle de productos -->
      <table class="table table-sm">
        <thead>
          <tr>
            <th>Producto</th>
            <th class="text-end">Cant</th>
            <th class="text-end">Precio</th>
            <th class="text-end">Subtotal</th>
          </tr>
        </thead>
        <tbody>
          {% for d in detalle %}
          <tr>
            <td>{{ d.producto or 'Producto #' + d.mercancia_id|string }}</td>
            <td class="text-end">{{ "%.2f"|format(d.cantidad) }}</td>
            <td class="text-end">${{ "%.2f"|format(d.precio_unitario) }}</td>
            <td class="text-end">${{ "%.2f"|format(d.subtotal) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <hr>
      
      <!-- Total -->
      <div class="row">
        <div class="col-6"></div>
        <div class="col-6">
          <h4 class="text-end">Total: ${{ "%.2f"|format(venta.total) }}</h4>
        </div>
      </div>

      <!-- Botones -->
      <div class="d-flex gap-2 mt-4">
        <a href="{{ url_for('historial_tickets') }}" class="btn btn-secondary">
          ‚Üê Volver al Historial
        </a>
        <button onclick="window.print()" class="btn btn-outline-primary">
          üñ®Ô∏è Imprimir
        </button>
      </div>

    </div>
  </div>
</div>

{% endblock %}